{% extends "base.html" %}
{% load static %}

{%block initial%}
    <h1 class="me-4">Настройки: {{ user.username }}</h1>
    <a href="{% url 'index' %}">Новые вопросы</a>
{%endblock%}


{%block content%}
  <form class="w-100" id="questionForm" method="post" enctype="multipart/form-data">
      {% csrf_token %}
      {{ form.non_field_errors }}
     
    <div class="form-group row  mt-4">
        <label for="rating" class="col-sm-3 col-form-label">Рейтинг</label>
        <div class="col-sm-10">
            <input type="text" class="form-control input-val " id="rating" maxlength="50" value="{{ user.profile.rating }}" readonly>
        </div>
    </div>

    <div class="form-group row  mt-4">
        <label for="email" class="col-sm-3 col-form-label">Почта</label>
        <div class="col-sm-10">
            {{ form.email }}
            {% for error in form.email.errors %}
                {{ error }}
            {% endfor %}
        </div>
    </div>

    <div class="form-group row  mt-4">
        <label for="username" class="col-sm-3 col-form-label">Имя пользователя</label>
        <div class="col-sm-10">
          {{ form.username }}
            {% for error in form.username.errors %}
                {{ error }}
            {% endfor %}
        </div>
    </div>

    <div class="form-group row mt-4">
        <label for="avatar" class="col-sm-3 col-form-label">Аватарка</label>
        <div class="col-sm-10">
            {% if user.profile.avatar %}
                <img style="width: 200px" src="{{ request.user.profile.avatar.url }}" alt="Avatar" class="img-thumbnail mb-3" style="width: 100px; height: 100px;">
              {% else %}
                <img style="width: 200px" src="{% static 'img/default-avatar.png' %}" alt="Avatar" class="img-thumbnail mb-3" style="width: 50px; height: 50px;">
            {% endif %}

            <div class="d-flex">
                 {{ form.avatar }}
                 <span class="form-control input-file-val" id="fileLabel">Выберите файл</span>
                 <button class="btn btn-success choose-button ms-3" type="button" onclick="document.getElementById('fileInput').click()">
                      Выбрать
                  </button>
            </div>
       </div>
    </div>
    
    <button class="btn btn-success col-sm-3  mt-5" type="submit">Сохранить!</button>
  </form>              

  <script>
    const fileInput = document.getElementById('fileInput');
    const fileLabel = document.getElementById('fileLabel');

    fileInput.addEventListener('change', function() {
        if (fileInput.files.length > 0) {
            fileLabel.textContent = fileInput.files[0].name; // Отображаем имя файла
        } else {
            fileLabel.textContent = 'Choose file'; // Сбрасываем текст, если файл не выбран
        }
    });
</script>
{%endblock%}

